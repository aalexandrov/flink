package org.apache.flink.ml.feature

import org.apache.flink.api.scala.ExecutionEnvironment
import org.apache.flink.test.util.FlinkTestBase
import org.scalatest.{Matchers, FlatSpec}
import org.apache.flink.api.scala._
import org.apache.flink.ml.common.{Parameter, ParameterMap, Transformer}


/**
 * @author Ronny Br√§unlich
 * @author Vassil Dimov
 * @author Filip Perisic
 */
class TfIdfTransformerSuite extends FlatSpec with Matchers with FlinkTestBase{

  behavior of "Test_01: The tf idf transformer implementation on one document where tf is divided by the most frequent word from all documents"
  it should "calculate four times zero for four words in only one document" in {

    val env = ExecutionEnvironment.getExecutionEnvironment
    val input = "This is a test !! !!".toLowerCase.split("\\s+").toSeq
    val documentKey = 1

    val inputDs = env.fromCollection(Seq((documentKey, input)))
    val transformer = new TfIdfTransformer()

    val result = transformer.transform(inputDs)
    val resultColl = result.collect()

    resultColl.length should be(1)
    resultColl(0)._1 should be(documentKey)
    resultColl(0)._2.size should be(4)

  }

  behavior of "Test_02: The tf idf transformer implementation on one document when tf is divided by the most frequent word from all documents"
  it should "calculate two times zero for four words in only one document with stop word parameters" in {

    val env = ExecutionEnvironment.getExecutionEnvironment
    val input = "This is a test".toLowerCase.split("\\s+").toSeq
    val documentKey = 1

    val inputDs = env.fromCollection(Seq((documentKey, input)))
    val transformer = new TfIdfTransformer()

    val params = new ParameterMap()
    params.add(StopWordParameter, Set("test", "a"))

    val result = transformer.transform(inputDs,params)
    val resultColl = result.collect()

    resultColl.length should be(1)
    resultColl(0)._1 should be(documentKey)
    resultColl(0)._2.size should be(2)

    // This is not the case any more since we use the formula tf * ( idf + 1 )
    //for (x <- resultColl(0)._2) {
    //  x._2 should be(0.0)
    // }
  }

  behavior of "Test_03: The tf idf transformer implementation on two documents when tf is divided by the most frequent word from all documents"
  it should "calculate non zero result for tf-idf" in {

    val env = ExecutionEnvironment.getExecutionEnvironment
    val input = "First line!".toLowerCase.split("\\s+").toSeq
    val documentKey = 1

    val input2 = "And here more, more more, more! more more more line".toLowerCase.split("\\s+").toSeq
    val documentKey2 = 2

    val inputDs = env.fromCollection(Seq((documentKey, input), (documentKey2, input2)))
    val transformer = new TfIdfTransformer()

    val result = transformer.transform(inputDs)
    val resultColl = result.collect()

    resultColl.length should be(2)
    for(elem <- resultColl) {
      elem._1 should be(documentKey).or(be(documentKey2))
      elem._2.size should be(4)

      for (x <- elem._2) {
        x._2 shouldBe >(0.0)
        x._2 shouldBe <(1.0)
      }
    }
  }


  behavior of "Test_04: Running TF-IDF on tree read poems."
  it should "return almost the same results as Python's scikit tf idf implementation" in {

    val env = ExecutionEnvironment.getExecutionEnvironment


    // 1. given

    val expectedResultCollectionLength = 3

    val passionatePilgrimPath = "the_passionate_pilgrim.txt"
    val passionatePilgrimKey = 1
   // val passionatePilgrimSource = scala.io.Source.fromFile(passionatePilgrimPath)
   // val passionatePilgrimLines = try passionatePilgrimSource.mkString finally passionatePilgrimSource.close()


    //    val loversComplaintPath = "a_lovers_complaint.txt"
    //    val loversComplaintKey = 2
    //    val loversComplaintSource = scala.io.Source.fromFile(loversComplaintPath)
    //    val loversComplaintLines = try loversComplaintSource.mkString finally loversComplaintSource.close()
    //
    //    val phoenixAndTurtlePath ="the_phoenix_and_the_turtle.txt"
    //    val phoenixAndTurtleKey = 3
    //    val phoenixAndTurtleSource = scala.io.Source.fromFile(phoenixAndTurtlePath)
    //    val phoenixAndTurtleLines = try phoenixAndTurtleSource.mkString finally phoenixAndTurtleSource.close()

    // hard coded poems
   var inputString =  "From off a hill whose concave womb reworded\nA plaintful story from a sistering vale,\nMy spirits to attend this double voice accorded,\nAnd down I laid to list the sad-tuned tale;\nEre long espied a fickle maid full pale,\nTearing of papers, breaking rings a-twain,\nStorming her world with sorrow's wind and rain.\n\nUpon her head a platted hive of straw,\nWhich fortified her visage from the sun,\nWhereon the thought might think sometime it saw\nThe carcass of beauty spent and done:\nTime had not scythed all that youth begun,\nNor youth all quit; but, spite of heaven's fell rage,\nSome beauty peep'd through lattice of sear'd age.\n\nOft did she heave her napkin to her eyne,\nWhich on it had conceited characters,\nLaundering the silken figures in the brine\nThat season'd woe had pelleted in tears,\nAnd often reading what contents it bears;\nAs often shrieking undistinguish'd woe,\nIn clamours of all size, both high and low.\n\nSometimes her levell'd eyes their carriage ride,\nAs they did battery to the spheres intend;\nSometime diverted their poor balls are tied\nTo the orbed earth; sometimes they do extend\nTheir view right on; anon their gazes lend\nTo every place at once, and, nowhere fix'd,\nThe mind and sight distractedly commix'd.\n\nHer hair, nor loose nor tied in formal plat,\nProclaim'd in her a careless hand of pride\nFor some, untuck'd, descended her sheaved hat,\nHanging her pale and pined cheek beside;\nSome in her threaden fillet still did bide,\nAnd true to bondage would not break from thence,\nThough slackly braided in loose negligence.\n\nA thousand favours from a maund she drew\nOf amber, crystal, and of beaded jet,\nWhich one by one she in a river threw,\nUpon whose weeping margent she was set;\nLike usury, applying wet to wet,\nOr monarch's hands that let not bounty fall\nWhere want cries some, but where excess begs all.\n\nOf folded schedules had she many a one,\nWhich she perused, sigh'd, tore, and gave the flood;\nCrack'd many a ring of posied gold and bone\nBidding them find their sepulchres in mud;\nFound yet moe letters sadly penn'd in blood,\nWith sleided silk feat and affectedly\nEnswathed, and seal'd to curious secrecy.\n\nThese often bathed she in her fluxive eyes,\nAnd often kiss'd, and often 'gan to tear:\nCried 'O false blood, thou register of lies,\nWhat unapproved witness dost thou bear!\nInk would have seem'd more black and damned here!'\nThis said, in top of rage the lines she rents,\nBig discontent so breaking their contents.\n\nA reverend man that grazed his cattle nigh\nSometime a blusterer, that the ruffle knew\nOf court, of city, and had let go by\nThe swiftest hours, observed as they flew\nTowards this afflicted fancy fastly drew,\nAnd, privileged by age, desires to know\nIn brief the grounds and motives of her woe.\n\nSo slides he down upon his grained bat,\nAnd comely-distant sits he by her side;\nWhen he again desires her, being sat,\nHer grievance with his hearing to divide:\nIf that from him there may be aught applied\nWhich may her suffering ecstasy assuage,\n'Tis promised in the charity of age.\n\n'Father,' she says, 'though in me you behold\nThe injury of many a blasting hour,\nLet it not tell your judgment I am old;\nNot age, but sorrow, over me hath power:\nI might as yet have been a spreading flower,\nFresh to myself, If I had self-applied\nLove to myself and to no love beside.\n\n'But, woe is me! too early I attended\nA youthful suit, it was to gain my grace\nOf one by nature's outwards so commended,\nThat maidens' eyes stuck over all his face:\nLove lack'd a dwelling, and made him her place;\nAnd when in his fair parts she did abide,\nShe was new lodged and newly deified.\n\n'His browny locks did hang in crooked curls;\nAnd every light occasion of the wind\nUpon his lips their silken parcels hurls.\nWhat's sweet to do, to do will aptly find:\nEach eye that saw him did enchant the mind,\nFor on his visage was in little drawn\nWhat largeness thinks in Paradise was sawn.\n\n'Small show of man was yet upon his chin;\nHis phoenix down began but to appear\nLike unshorn velvet on that termless skin\nWhose bare out-bragg'd the web it seem'd to wear:\nYet show'd his visage by that cost more dear;\nAnd nice affections wavering stood in doubt\nIf best were as it was, or best without.\n\n'His qualities were beauteous as his form,\nFor maiden-tongued he was, and thereof free;\nYet, if men moved him, was he such a storm\nAs oft 'twixt May and April is to see,\nWhen winds breathe sweet, untidy though they be.\nHis rudeness so with his authorized youth\nDid livery falseness in a pride of truth.\n\n'Well could he ride, and often men would say\n'That horse his mettle from his rider takes:\nProud of subjection, noble by the sway,\nWhat rounds, what bounds, what course, what stop\nhe makes!'\nAnd controversy hence a question takes,\nWhether the horse by him became his deed,\nOr he his manage by the well-doing steed.\n\n'But quickly on this side the verdict went:\nHis real habitude gave life and grace\nTo appertainings and to ornament,\nAccomplish'd in himself, not in his case:\nAll aids, themselves made fairer by their place,\nCame for additions; yet their purposed trim\nPieced not his grace, but were all graced by him.\n\n'So on the tip of his subduing tongue\nAll kinds of arguments and question deep,\nAll replication prompt, and reason strong,\nFor his advantage still did wake and sleep:\nTo make the weeper laugh, the laugher weep,\nHe had the dialect and different skill,\nCatching all passions in his craft of will:\n\n'That he did in the general bosom reign\nOf young, of old; and sexes both enchanted,\nTo dwell with him in thoughts, or to remain\nIn personal duty, following where he haunted:\nConsents bewitch'd, ere he desire, have granted;\nAnd dialogued for him what he would say,\nAsk'd their own wills, and made their wills obey.\n\n'Many there were that did his picture get,\nTo serve their eyes, and in it put their mind;\nLike fools that in th' imagination set\nThe goodly objects which abroad they find\nOf lands and mansions, theirs in thought assign'd;\nAnd labouring in moe pleasures to bestow them\nThan the true gouty landlord which doth owe them:\n\n'So many have, that never touch'd his hand,\nSweetly supposed them mistress of his heart.\nMy woeful self, that did in freedom stand,\nAnd was my own fee-simple, not in part,\nWhat with his art in youth, and youth in art,\nThrew my affections in his charmed power,\nReserved the stalk and gave him all my flower.\n\n'Yet did I not, as some my equals did,\nDemand of him, nor being desired yielded;\nFinding myself in honour so forbid,\nWith safest distance I mine honour shielded:\nExperience for me many bulwarks builded\nOf proofs new-bleeding, which remain'd the foil\nOf this false jewel, and his amorous spoil.\n\n'But, ah, who ever shunn'd by precedent\nThe destined ill she must herself assay?\nOr forced examples, 'gainst her own content,\nTo put the by-past perils in her way?\nCounsel may stop awhile what will not stay;\nFor when we rage, advice is often seen\nBy blunting us to make our wits more keen.\n\n'Nor gives it satisfaction to our blood,\nThat we must curb it upon others' proof;\nTo be forbod the sweets that seem so good,\nFor fear of harms that preach in our behoof.\nO appetite, from judgment stand aloof!\nThe one a palate hath that needs will taste,\nThough Reason weep, and cry, 'It is thy last.'\n\n'For further I could say 'This man's untrue,'\nAnd knew the patterns of his foul beguiling;\nHeard where his plants in others' orchards grew,\nSaw how deceits were gilded in his smiling;\nKnew vows were ever brokers to defiling;\nThought characters and words merely but art,\nAnd bastards of his foul adulterate heart.\n\n'And long upon these terms I held my city,\nTill thus he gan besiege me: 'Gentle maid,\nHave of my suffering youth some feeling pity,\nAnd be not of my holy vows afraid:\nThat's to ye sworn to none was ever said;\nFor feasts of love I have been call'd unto,\nTill now did ne'er invite, nor never woo.\n\n'All my offences that abroad you see\nAre errors of the blood, none of the mind;\nLove made them not: with acture they may be,\nWhere neither party is nor true nor kind:\nThey sought their shame that so their shame did find;\nAnd so much less of shame in me remains,\nBy how much of me their reproach contains.\n\n'Among the many that mine eyes have seen,\nNot one whose flame my heart so much as warm'd,\nOr my affection put to the smallest teen,\nOr any of my leisures ever charm'd:\nHarm have I done to them, but ne'er was harm'd;\nKept hearts in liveries, but mine own was free,\nAnd reign'd, commanding in his monarchy.\n\n'Look here, what tributes wounded fancies sent me,\nOf paled pearls and rubies red as blood;\nFiguring that they their passions likewise lent me\nOf grief and blushes, aptly understood\nIn bloodless white and the encrimson'd mood;\nEffects of terror and dear modesty,\nEncamp'd in hearts, but fighting outwardly.\n\n'And, lo, behold these talents of their hair,\nWith twisted metal amorously impleach'd,\nI have received from many a several fair,\nTheir kind acceptance weepingly beseech'd,\nWith the annexions of fair gems enrich'd,\nAnd deep-brain'd sonnets that did amplify\nEach stone's dear nature, worth, and quality.\n\n'The diamond, why, 'twas beautiful and hard,\nWhereto his invised properties did tend;\nThe deep-green emerald, in whose fresh regard\nWeak sights their sickly radiance do amend;\nThe heaven-hued sapphire and the opal blend\nWith objects manifold: each several stone,\nWith wit well blazon'd, smiled or made some moan.\n\n'Lo, all these trophies of affections hot,\nOf pensived and subdued desires the tender,\nNature hath charged me that I hoard them not,\nBut yield them up where I myself must render,\nThat is, to you, my origin and ender;\nFor these, of force, must your oblations be,\nSince I their altar, you enpatron me.\n\n'O, then, advance of yours that phraseless hand,\nWhose white weighs down the airy scale of praise;\nTake all these similes to your own command,\nHallow'd with sighs that burning lungs did raise;\nWhat me your minister, for you obeys,\nWorks under you; and to your audit comes\nTheir distract parcels in combined sums.\n\n'Lo, this device was sent me from a nun,\nOr sister sanctified, of holiest note;\nWhich late her noble suit in court did shun,\nWhose rarest havings made the blossoms dote;\nFor she was sought by spirits of richest coat,\nBut kept cold distance, and did thence remove,\nTo spend her living in eternal love.\n\n'But, O my sweet, what labour is't to leave\nThe thing we have not, mastering what not strives,\nPlaying the place which did no form receive,\nPlaying patient sports in unconstrained gyves?\nShe that her fame so to herself contrives,\nThe scars of battle 'scapeth by the flight,\nAnd makes her absence valiant, not her might.\n\n'O, pardon me, in that my boast is true:\nThe accident which brought me to her eye\nUpon the moment did her force subdue,\nAnd now she would the caged cloister fly:\nReligious love put out Religion's eye:\nNot to be tempted, would she be immured,\nAnd now, to tempt, all liberty procured.\n\n'How mighty then you are, O, hear me tell!\nThe broken bosoms that to me belong\nHave emptied all their fountains in my well,\nAnd mine I pour your ocean all among:\nI strong o'er them, and you o'er me being strong,\nMust for your victory us all congest,\nAs compound love to physic your cold breast.\n\n'My parts had power to charm a sacred nun,\nWho, disciplined, ay, dieted in grace,\nBelieved her eyes when they to assail begun,\nAll vows and consecrations giving place:\nO most potential love! vow, bond, nor space,\nIn thee hath neither sting, knot, nor confine,\nFor thou art all, and all things else are thine.\n\n'When thou impressest, what are precepts worth\nOf stale example? When thou wilt inflame,\nHow coldly those impediments stand forth\nOf wealth, of filial fear, law, kindred, fame!\nLove's arms are peace, 'gainst rule, 'gainst sense,\n'gainst shame,\nAnd sweetens, in the suffering pangs it bears,\nThe aloes of all forces, shocks, and fears.\n\n'Now all these hearts that do on mine depend,\nFeeling it break, with bleeding groans they pine;\nAnd supplicant their sighs to you extend,\nTo leave the battery that you make 'gainst mine,\nLending soft audience to my sweet design,\nAnd credent soul to that strong-bonded oath\nThat shall prefer and undertake my troth.'\n\n'This said, his watery eyes he did dismount,\nWhose sights till then were levell'd on my face;\nEach cheek a river running from a fount\nWith brinish current downward flow'd apace:\nO, how the channel to the stream gave grace!\nWho glazed with crystal gate the glowing roses\nThat flame through water which their hue encloses.\n\n'O father, what a hell of witchcraft lies\nIn the small orb of one particular tear!\nBut with the inundation of the eyes\nWhat rocky heart to water will not wear?\nWhat breast so cold that is not warmed here?\nO cleft effect! cold modesty, hot wrath,\nBoth fire from hence and chill extincture hath.\n\n'For, lo, his passion, but an art of craft,\nEven there resolved my reason into tears;\nThere my white stole of chastity I daff'd,\nShook off my sober guards and civil fears;\nAppear to him, as he to me appears,\nAll melting; though our drops this difference bore,\nHis poison'd me, and mine did him restore.\n\n'In him a plenitude of subtle matter,\nApplied to cautels, all strange forms receives,\nOf burning blushes, or of weeping water,\nOr swooning paleness; and he takes and leaves,\nIn either's aptness, as it best deceives,\nTo blush at speeches rank to weep at woes,\nOr to turn white and swoon at tragic shows.\n\n'That not a heart which in his level came\nCould 'scape the hail of his all-hurting aim,\nShowing fair nature is both kind and tame;\nAnd, veil'd in them, did win whom he would maim:\nAgainst the thing he sought he would exclaim;\nWhen he most burn'd in heart-wish'd luxury,\nHe preach'd pure maid, and praised cold chastity.\n\n'Thus merely with the garment of a Grace\nThe naked and concealed fiend he cover'd;\nThat th' unexperient gave the tempter place,\nWhich like a cherubin above them hover'd.\nWho, young and simple, would not be so lover'd?\nAy me! I fell; and yet do question make\nWhat I should do again for such a sake.\n\n'O, that infected moisture of his eye,\nO, that false fire which in his cheek so glow'd,\nO, that forced thunder from his heart did fly,\nO, that sad breath his spongy lungs bestow'd,\nO, all that borrow'd motion seeming owed,\nWould yet again betray the fore-betray'd,\nAnd new pervert a reconciled maid!'"


    val input = inputString.toLowerCase.split("\\s+").toSeq

    // 2. when
    val inputDs = env.fromCollection(Seq((passionatePilgrimKey, input)))
    val resultCollection = new TfIdfTransformer().transform(inputDs).collect()

    // 3. then
    resultCollection.length should be (1)

  }

  behavior of "Test_05: Running TF-IDF on tree hard coded poems."
  it should "return the same results as \"Running TF-IDF on tree read poems \" test" in {

    val env = ExecutionEnvironment.getExecutionEnvironment

    // 1. given
    val expectedResultCollectionLength = 3

    val passionatePilgrimKey = 1
    var passionatePilgrimString =  "When my love swears that she is made of truth,\nI do believe her, though I know she lies,\nThat she might think me some untutor'd youth,\nUnskilful in the world's false forgeries.\nThus vainly thinking that she thinks me young,\nAlthough I know my years be past the best,\nI smiling credit her false-speaking tongue,\nOutfacing faults in love with love's ill rest.\nBut wherefore says my love that she is young?\nAnd wherefore say not I that I am old?\nO, love's best habit is a soothing tongue,\nAnd age, in love, loves not to have years told.\nTherefore I'll lie with love, and love with me,\nSince that our faults in love thus smother'd be.\n\n\nTwo loves I have, of comfort and despair,\nThat like two spirits do suggest me still;\nMy better angel is a man right fair,\nMy worser spirit a woman colour'd ill.\nTo win me soon to hell, my female evil\nTempteth my better angel from my side,\nAnd would corrupt my saint to be a devil,\nWooing his purity with her fair pride.\nAnd whether that my angel be turn'd fiend,\nSuspect I may, yet not directly tell:\nFor being both to me, both to each friend,\nI guess one angel in another's hell;\nThe truth I shall not know, but live in doubt,\nTill my bad angel fire my good one out.\n\n\nDid not the heavenly rhetoric of thine eye,\n'Gainst whom the world could not hold argument,\nPersuade my heart to this false perjury?\nVows for thee broke deserve not punishment.\nA woman I forswore; but I will prove,\nThou being a goddess, I forswore not thee:\nMy vow was earthly, thou a heavenly love;\nThy grace being gain'd cures all disgrace in me.\nMy vow was breath, and breath a vapour is;\nThen, thou fair sun, that on this earth doth shine,\nExhale this vapour vow; in thee it is:\nIf broken, then it is no fault of mine.\nIf by me broke, what fool is not so wise\nTo break an oath, to win a paradise?\n\n\nSweet Cytherea, sitting by a brook\nWith young Adonis, lovely, fresh, and green,\nDid court the lad with many a lovely look,\nSuch looks as none could look but beauty's queen.\nShe told him stories to delight his ear;\nShe showed him favors to allure his eye;\nTo win his heart, she touch'd him here and there,\nTouches so soft still conquer chastity.\nBut whether unripe years did want conceit,\nOr he refused to take her figured proffer,\nThe tender nibbler would not touch the bait,\nBut smile and jest at every gentle offer:\nThen fell she on her back, fair queen, and toward:\nHe rose and ran away; ah, fool too froward!\n\n\nIf love make me forsworn, how shall I swear to love?\nO never faith could hold, if not to beauty vow'd:\nThough to myself forsworn, to thee I'll constant prove;\nThose thoughts, to me like oaks, to thee like osiers bow'd.\nStudy his bias leaves, and makes his book thine eyes,\nWhere all those pleasures live that art can comprehend.\nIf knowledge be the mark, to know thee shall suffice;\nWell learned is that tongue that well can thee commend;\nAll ignorant that soul that sees thee without wonder;\nWhich is to me some praise, that I thy parts admire:\nThine eye Jove's lightning seems, thy voice his dreadful\nthunder,\nWhich, not to anger bent, is music and sweet fire.\nCelestial as thou art, O do not love that wrong,\nTo sing heaven's praise with such an earthly tongue.\n\n\nScarce had the sun dried up the dewy morn,\nAnd scarce the herd gone to the hedge for shade,\nWhen Cytherea, all in love forlorn,\nA longing tarriance for Adonis made\nUnder an osier growing by a brook,\nA brook where Adon used to cool his spleen:\nHot was the day; she hotter that did look\nFor his approach, that often there had been.\nAnon he comes, and throws his mantle by,\nAnd stood stark naked on the brook's green brim:\nThe sun look'd on the world with glorious eye,\nYet not so wistly as this queen on him.\nHe, spying her, bounced in, whereas he stood:\n'O Jove,' quoth she, 'why was not I a flood!'\n\n\nFair is my love, but not so fair as fickle;\nMild as a dove, but neither true nor trusty;\nBrighter than glass, and yet, as glass is, brittle;\nSofter than wax, and yet, as iron, rusty:\nA lily pale, with damask dye to grace her,\nNone fairer, nor none falser to deface her.\n\nHer lips to mine how often hath she joined,\nBetween each kiss her oaths of true love swearing!\nHow many tales to please me hath she coined,\nDreading my love, the loss thereof still fearing!\nYet in the midst of all her pure protestings,\nHer faith, her oaths, her tears, and all were jestings.\n\nShe burn'd with love, as straw with fire flameth;\nShe burn'd out love, as soon as straw outburneth;\nShe framed the love, and yet she foil'd the framing;\nShe bade love last, and yet she fell a-turning.\nWas this a lover, or a lecher whether?\nBad in the best, though excellent in neither.\n\n\nIf music and sweet poetry agree,\nAs they must needs, the sister and the brother,\nThen must the love be great 'twixt thee and me,\nBecause thou lovest the one, and I the other.\nDowland to thee is dear, whose heavenly touch\nUpon the lute doth ravish human sense;\nSpenser to me, whose deep conceit is such\nAs, passing all conceit, needs no defence.\nThou lovest to hear the sweet melodious sound\nThat Phoebus' lute, the queen of music, makes;\nAnd I in deep delight am chiefly drown'd\nWhen as himself to singing he betakes.\nOne god is god of both, as poets feign;\nOne knight loves both, and both in thee remain.\n\n\nFair was the morn when the fair queen of love,\nPaler for sorrow than her milk-white dove,\nFor Adon's sake, a youngster proud and wild;\nHer stand she takes upon a steep-up hill:\nAnon Adonis comes with horn and hounds;\nShe, silly queen, with more than love's good will,\nForbade the boy he should not pass those grounds:\n'Once,' quoth she, 'did I see a fair sweet youth\nHere in these brakes deep-wounded with a boar,\nDeep in the thigh, a spectacle of ruth!\nSee, in my thigh,' quoth she, 'here was the sore.'\nShe showed hers: he saw more wounds than one,\nAnd blushing fled, and left her all alone.\n\n\nSweet rose, fair flower, untimely pluck'd, soon vaded,\nPluck'd in the bud, and vaded in the spring!\nBright orient pearl, alack, too timely shaded!\nFair creature, kill'd too soon by death's sharp sting!\nLike a green plum that hangs upon a tree,\nAnd falls, through wind, before the fall should be.\n\nI weep for thee, and yet no cause I have;\nFor why thou left'st me nothing in thy will:\nAnd yet thou left'st me more than I did crave;\nFor why I craved nothing of thee still:\nO yes, dear friend, I pardon crave of thee,\nThy discontent thou didst bequeath to me.\n\n\nVenus, with young Adonis sitting by her\nUnder a myrtle shade, began to woo him:\nShe told the youngling how god Mars did try her,\nAnd as he fell to her, so fell she to him.\n'Even thus,' quoth she, 'the warlike god embraced me,'\nAnd then she clipp'd Adonis in her arms;\n'Even thus,' quoth she, 'the warlike god unlaced me,'\nAs if the boy should use like loving charms;\n'Even thus,' quoth she, 'he seized on my lips,'\nAnd with her lips on his did act the seizure:\nAnd as she fetched breath, away he skips,\nAnd would not take her meaning nor her pleasure.\nAh, that I had my lady at this bay,\nTo kiss and clip me till I run away!\n\n\nCrabbed age and youth cannot live together:\nYouth is full of pleasance, age is full of care;\nYouth like summer morn, age like winter weather;\nYouth like summer brave, age like winter bare.\nYouth is full of sport, age's breath is short;\nYouth is nimble, age is lame;\nYouth is hot and bold, age is weak and cold;\nYouth is wild, and age is tame.\nAge, I do abhor thee; youth, I do adore thee;\nO, my love, my love is young!\nAge, I do defy thee: O, sweet shepherd, hie thee,\nFor methinks thou stay'st too long,\n\n\nBeauty is but a vain and doubtful good;\nA shining gloss that vadeth suddenly;\nA flower that dies when first it gins to bud;\nA brittle glass that's broken presently:\nA doubtful good, a gloss, a glass, a flower,\nLost, vaded, broken, dead within an hour.\n\nAnd as goods lost are seld or never found,\nAs vaded gloss no rubbing will refresh,\nAs flowers dead lie wither'd on the ground,\nAs broken glass no cement can redress,\nSo beauty blemish'd once's for ever lost,\nIn spite of physic, painting, pain and cost.\n\n\nGood night, good rest. Ah, neither be my share:\nShe bade good night that kept my rest away;\nAnd daff'd me to a cabin hang'd with care,\nTo descant on the doubts of my decay.\n'Farewell,' quoth she, 'and come again tomorrow:'\nFare well I could not, for I supp'd with sorrow.\n\nYet at my parting sweetly did she smile,\nIn scorn or friendship, nill I construe whether:\n'T may be, she joy'd to jest at my exile,\n'T may be, again to make me wander thither:\n'Wander,' a word for shadows like myself,\nAs take the pain, but cannot pluck the pelf.\n\n\nLord, how mine eyes throw gazes to the east!\nMy heart doth charge the watch; the morning rise\nDoth cite each moving sense from idle rest.\nNot daring trust the office of mine eyes,\nWhile Philomela sits and sings, I sit and mark,\nAnd wish her lays were tuned like the lark;\n\nFor she doth welcome daylight with her ditty,\nAnd drives away dark dismal-dreaming night:\nThe night so pack'd, I post unto my pretty;\nHeart hath his hope, and eyes their wished sight;\nSorrow changed to solace, solace mix'd with sorrow;\nFor why, she sigh'd and bade me come tomorrow.\n\nWere I with her, the night would post too soon;\nBut now are minutes added to the hours;\nTo spite me now, each minute seems a moon;\nYet not for me, shine sun to succor flowers!\nPack night, peep day; good day, of night now borrow:\nShort, night, to-night, and length thyself tomorrow.\n\nSonnet to sundry notes of music\n\nIt was a lording's daughter, the fairest one of three,\nThat liked of her master as well as well might be,\nTill looking on an Englishman, the fair'st that eye could see,\nHer fancy fell a-turning.\n\nLong was the combat doubtful that love with love did fight,\nTo leave the master loveless, or kill the gallant knight:\nTo put in practise either, alas, it was a spite\nUnto the silly damsel!\n\nBut one must be refused; more mickle was the pain\nThat nothing could be used to turn them both to gain,\nFor of the two the trusty knight was wounded with disdain:\nAlas, she could not help it!\n\nThus art with arms contending was victor of the day,\nWhich by a gift of learning did bear the maid away:\nThen, lullaby, the learned man hath got the lady gay;\nFor now my song is ended.\n\nSonnet to sundry notes of music\n\nOn a day, alack the day!\nLove, whose month was ever May,\nSpied a blossom passing fair,\nPlaying in the wanton air:\nThrough the velvet leaves the wind\nAll unseen, gan passage find;\nThat the lover, sick to death,\nWish'd himself the heaven's breath,\n'Air,' quoth he, 'thy cheeks may blow;\nAir, would I might triumph so!\nBut, alas! my hand hath sworn\nNe'er to pluck thee from thy thorn:\nVow, alack! for youth unmeet:\nYouth, so apt to pluck a sweet.\nThou for whom Jove would swear\nJuno but an Ethiope were;\nAnd deny himself for Jove,\nTurning mortal for thy love.'\n\nSonnet to sundry notes of music\n\nMy flocks feed not,\nMy ewes breed not,\nMy rams speed not,\nAll is amiss:\nLove's denying,\nFaith's defying,\nHeart's renying,\nCauser of this.\nAll my merry jigs are quite forgot,\nAll my lady's love is lost, God wot:\nWhere her faith was firmly fix'd in love,\nThere a nay is placed without remove.\nOne silly cross\nWrought all my loss;\nO frowning Fortune, cursed, fickle dame!\nFor now I see\nInconstancy\nMore in women than in men remain.\nIn black mourn I,\nAll fears scorn I,\nLove hath forlorn me,\nLiving in thrall:\nHeart is bleeding,\nAll help needing,\nO cruel speeding,\nFraughted with gall.\nMy shepherd's pipe can sound no deal;\nMy wether's bell rings doleful knell;\nMy curtail dog, that wont to have play'd\nPlays not at all, but seems afraid;\nMy sighs so deep\nProcure to weep,\nIn howling wise, to see my doleful plight.\nHow sighs resound\nThrough heartless ground,\n\nLike a thousand vanquish'd men in bloody fight!\nClear wells spring not,\nSweet birds sing not,\nGreen plants bring not\nForth their dye;\nHerds stand weeping,\nFlocks all sleeping,\nNymphs back peeping\nFearfully:\nAll our pleasure known to us poor swains,\nAll our merry meetings on the plains,\nAll our evening sport from us is fled,\nAll our love is lost, for Love is dead\nFarewell, sweet lass,\nThy like ne'er was\nFor a sweet content, the cause of all my moan:\nPoor Corydon\nMust live alone;\nOther help for him I see that there is none.\n\nSonnet to sundry notes of music\n\nWhen as thine eye hath chose the dame,\nAnd stall'd the deer that thou shouldst strike,\nLet reason rule things worthy blame,\nAs well as fancy partial might:\nTake counsel of some wiser head,\nNeither too young nor yet unwed.\n\nAnd when thou comest thy tale to tell,\nSmooth not thy tongue with filed talk,\nLest she some subtle practise smell,\nA cripple soon can find a halt;\nBut plainly say thou lovest her well,\n\nAnd set thy person forth to sell.\nWhat though her frowning brows be bent,\nHer cloudy looks will calm ere night:\nAnd then too late she will repent\nThat thus dissembled her delight;\nAnd twice desire, ere it be day,\nThat which with scorn she put away.\n\nWhat though she strive to try her strength,\nAnd ban and brawl, and say thee nay,\nHer feeble force will yield at length,\nWhen craft hath taught her thus to say,\n'Had women been so strong as men,\nIn faith, you had not had it then.'\n\nAnd to her will frame all thy ways;\nSpare not to spend, and chiefly there\nWhere thy desert may merit praise,\nBy ringing in thy lady's ear:\nThe strongest castle, tower, and town,\nThe golden bullet beats it down.\n\nServe always with assured trust,\nAnd in thy suit be humble true;\nUnless thy lady prove unjust,\nPress never thou to choose anew:\nWhen time shall serve, be thou not slack\nTo proffer, though she put thee back.\n\nThe wiles and guiles that women work,\nDissembled with an outward show,\nThe tricks and toys that in them lurk,\nThe cock that treads them shall not know.\nHave you not heard it said full oft,\nA woman's nay doth stand for nought?\n\nThink women still to strive with men,\nTo sin and never for to saint:\nThere is no heaven, by holy then,\nWhen time with age doth them attaint.\nWere kisses all the joys in bed,\nOne woman would another wed.\n\nBut, soft! enough, too much, I fear\nLest that my mistress hear my song,\nShe will not stick to round me i' the ear,\nTo teach my tongue to be so long:\nYet will she blush, here be it said,\nTo hear her secrets so bewray'd.\n\nSonnet to sundry notes of music\n\nLive with me, and be my love,\nAnd we will all the pleasures prove\nThat hills and valleys, dales and fields,\nAnd all the craggy mountains yields.\n\nThere will we sit upon the rocks,\nAnd see the shepherds feed their flocks,\nBy shallow rivers, by whose falls\nMelodious birds sing madrigals.\n\nThere will I make thee a bed of roses,\nWith a thousand fragrant posies,\nA cap of flowers, and a kirtle\nEmbroider'd all with leaves of myrtle.\n\nA belt of straw and ivy buds,\nWith coral clasps and amber studs;\nAnd if these pleasures may thee move,\nThen live with me and be my love.\n\n[Love's Answer]\nIf that the world and love were young,\nAnd truth in every shepherd's tongue,\nThese pretty pleasures might me move\nTo live with thee and be thy love.\n\nSonnet to sundry notes of music\n\nAs it fell upon a day\nIn the merry month of May,\nSitting in a pleasant shade\nWhich a grove of myrtles made,\nBeasts did leap, and birds did sing,\nTrees did grow, and plants did spring;\nEvery thing did banish moan,\nSave the nightingale alone:\nShe, poor bird, as all forlorn,\nLean'd her breast up-till a thorn\nAnd there sung the dolefull'st ditty,\nThat to hear it was great pity:\n'Fie, fie, fie,' now would she cry;\n'Tereu, tereu!' by and by;\nThat to hear her so complain,\nScarce I could from tears refrain;\nFor her griefs, so lively shown,\nMade me think upon mine own.\nAh, thought I, thou mourn'st in vain!\nNone takes pity on thy pain:\nSenseless trees they cannot hear thee;\nRuthless beasts they will not cheer thee:\nKing Pandion he is dead;\nAll thy friends are lapp'd in lead;\nAll thy fellow birds do sing,\nCareless of thy sorrowing.\nEven so, poor bird, like thee,\nNone alive will pity me.\nWhilst as fickle Fortune smiled,\nThou and I were both beguiled.\nEvery one that flatters thee\nIs no friend in misery.\nWords are easy, like the wind;\nFaithful friends are hard to find:\nEvery man will be thy friend\nWhilst thou hast wherewith to spend;\nBut if store of crowns be scant,\nNo man will supply thy want.\nIf that one be prodigal,\nBountiful they will him call,\nAnd with such-like flattering,\n'Pity but he were a king;'\nIf he be addict to vice,\nQuickly him they will entice;\nIf to women he be bent,\nThey have at commandement:\nBut if Fortune once do frown,\nThen farewell his great renown\nThey that fawn'd on him before\nUse his company no more.\nHe that is thy friend indeed,\nHe will help thee in thy need:\nIf thou sorrow, he will weep;\nIf thou wake, he cannot sleep;\nThus of every grief in heart\nHe with thee doth bear a part.\nThese are certain signs to know\nFaithful friend from flattering foe."
    val passionatePilgrimInput = passionatePilgrimString.toLowerCase.split(" ").toSeq

    val loversComplaintKey = 2
    var loversComplaintString = "From off a hill whose concave womb reworded\nA plaintful story from a sistering vale,\nMy spirits to attend this double voice accorded,\nAnd down I laid to list the sad-tuned tale;\nEre long espied a fickle maid full pale,\nTearing of papers, breaking rings a-twain,\nStorming her world with sorrow's wind and rain.\n\nUpon her head a platted hive of straw,\nWhich fortified her visage from the sun,\nWhereon the thought might think sometime it saw\nThe carcass of beauty spent and done:\nTime had not scythed all that youth begun,\nNor youth all quit; but, spite of heaven's fell rage,\nSome beauty peep'd through lattice of sear'd age.\n\nOft did she heave her napkin to her eyne,\nWhich on it had conceited characters,\nLaundering the silken figures in the brine\nThat season'd woe had pelleted in tears,\nAnd often reading what contents it bears;\nAs often shrieking undistinguish'd woe,\nIn clamours of all size, both high and low.\n\nSometimes her levell'd eyes their carriage ride,\nAs they did battery to the spheres intend;\nSometime diverted their poor balls are tied\nTo the orbed earth; sometimes they do extend\nTheir view right on; anon their gazes lend\nTo every place at once, and, nowhere fix'd,\nThe mind and sight distractedly commix'd.\n\nHer hair, nor loose nor tied in formal plat,\nProclaim'd in her a careless hand of pride\nFor some, untuck'd, descended her sheaved hat,\nHanging her pale and pined cheek beside;\nSome in her threaden fillet still did bide,\nAnd true to bondage would not break from thence,\nThough slackly braided in loose negligence.\n\nA thousand favours from a maund she drew\nOf amber, crystal, and of beaded jet,\nWhich one by one she in a river threw,\nUpon whose weeping margent she was set;\nLike usury, applying wet to wet,\nOr monarch's hands that let not bounty fall\nWhere want cries some, but where excess begs all.\n\nOf folded schedules had she many a one,\nWhich she perused, sigh'd, tore, and gave the flood;\nCrack'd many a ring of posied gold and bone\nBidding them find their sepulchres in mud;\nFound yet moe letters sadly penn'd in blood,\nWith sleided silk feat and affectedly\nEnswathed, and seal'd to curious secrecy.\n\nThese often bathed she in her fluxive eyes,\nAnd often kiss'd, and often 'gan to tear:\nCried 'O false blood, thou register of lies,\nWhat unapproved witness dost thou bear!\nInk would have seem'd more black and damned here!'\nThis said, in top of rage the lines she rents,\nBig discontent so breaking their contents.\n\nA reverend man that grazed his cattle nigh\nSometime a blusterer, that the ruffle knew\nOf court, of city, and had let go by\nThe swiftest hours, observed as they flew\nTowards this afflicted fancy fastly drew,\nAnd, privileged by age, desires to know\nIn brief the grounds and motives of her woe.\n\nSo slides he down upon his grained bat,\nAnd comely-distant sits he by her side;\nWhen he again desires her, being sat,\nHer grievance with his hearing to divide:\nIf that from him there may be aught applied\nWhich may her suffering ecstasy assuage,\n'Tis promised in the charity of age.\n\n'Father,' she says, 'though in me you behold\nThe injury of many a blasting hour,\nLet it not tell your judgment I am old;\nNot age, but sorrow, over me hath power:\nI might as yet have been a spreading flower,\nFresh to myself, If I had self-applied\nLove to myself and to no love beside.\n\n'But, woe is me! too early I attended\nA youthful suit, it was to gain my grace\nOf one by nature's outwards so commended,\nThat maidens' eyes stuck over all his face:\nLove lack'd a dwelling, and made him her place;\nAnd when in his fair parts she did abide,\nShe was new lodged and newly deified.\n\n'His browny locks did hang in crooked curls;\nAnd every light occasion of the wind\nUpon his lips their silken parcels hurls.\nWhat's sweet to do, to do will aptly find:\nEach eye that saw him did enchant the mind,\nFor on his visage was in little drawn\nWhat largeness thinks in Paradise was sawn.\n\n'Small show of man was yet upon his chin;\nHis phoenix down began but to appear\nLike unshorn velvet on that termless skin\nWhose bare out-bragg'd the web it seem'd to wear:\nYet show'd his visage by that cost more dear;\nAnd nice affections wavering stood in doubt\nIf best were as it was, or best without.\n\n'His qualities were beauteous as his form,\nFor maiden-tongued he was, and thereof free;\nYet, if men moved him, was he such a storm\nAs oft 'twixt May and April is to see,\nWhen winds breathe sweet, untidy though they be.\nHis rudeness so with his authorized youth\nDid livery falseness in a pride of truth.\n\n'Well could he ride, and often men would say\n'That horse his mettle from his rider takes:\nProud of subjection, noble by the sway,\nWhat rounds, what bounds, what course, what stop\nhe makes!'\nAnd controversy hence a question takes,\nWhether the horse by him became his deed,\nOr he his manage by the well-doing steed.\n\n'But quickly on this side the verdict went:\nHis real habitude gave life and grace\nTo appertainings and to ornament,\nAccomplish'd in himself, not in his case:\nAll aids, themselves made fairer by their place,\nCame for additions; yet their purposed trim\nPieced not his grace, but were all graced by him.\n\n'So on the tip of his subduing tongue\nAll kinds of arguments and question deep,\nAll replication prompt, and reason strong,\nFor his advantage still did wake and sleep:\nTo make the weeper laugh, the laugher weep,\nHe had the dialect and different skill,\nCatching all passions in his craft of will:\n\n'That he did in the general bosom reign\nOf young, of old; and sexes both enchanted,\nTo dwell with him in thoughts, or to remain\nIn personal duty, following where he haunted:\nConsents bewitch'd, ere he desire, have granted;\nAnd dialogued for him what he would say,\nAsk'd their own wills, and made their wills obey.\n\n'Many there were that did his picture get,\nTo serve their eyes, and in it put their mind;\nLike fools that in th' imagination set\nThe goodly objects which abroad they find\nOf lands and mansions, theirs in thought assign'd;\nAnd labouring in moe pleasures to bestow them\nThan the true gouty landlord which doth owe them:\n\n'So many have, that never touch'd his hand,\nSweetly supposed them mistress of his heart.\nMy woeful self, that did in freedom stand,\nAnd was my own fee-simple, not in part,\nWhat with his art in youth, and youth in art,\nThrew my affections in his charmed power,\nReserved the stalk and gave him all my flower.\n\n'Yet did I not, as some my equals did,\nDemand of him, nor being desired yielded;\nFinding myself in honour so forbid,\nWith safest distance I mine honour shielded:\nExperience for me many bulwarks builded\nOf proofs new-bleeding, which remain'd the foil\nOf this false jewel, and his amorous spoil.\n\n'But, ah, who ever shunn'd by precedent\nThe destined ill she must herself assay?\nOr forced examples, 'gainst her own content,\nTo put the by-past perils in her way?\nCounsel may stop awhile what will not stay;\nFor when we rage, advice is often seen\nBy blunting us to make our wits more keen.\n\n'Nor gives it satisfaction to our blood,\nThat we must curb it upon others' proof;\nTo be forbod the sweets that seem so good,\nFor fear of harms that preach in our behoof.\nO appetite, from judgment stand aloof!\nThe one a palate hath that needs will taste,\nThough Reason weep, and cry, 'It is thy last.'\n\n'For further I could say 'This man's untrue,'\nAnd knew the patterns of his foul beguiling;\nHeard where his plants in others' orchards grew,\nSaw how deceits were gilded in his smiling;\nKnew vows were ever brokers to defiling;\nThought characters and words merely but art,\nAnd bastards of his foul adulterate heart.\n\n'And long upon these terms I held my city,\nTill thus he gan besiege me: 'Gentle maid,\nHave of my suffering youth some feeling pity,\nAnd be not of my holy vows afraid:\nThat's to ye sworn to none was ever said;\nFor feasts of love I have been call'd unto,\nTill now did ne'er invite, nor never woo.\n\n'All my offences that abroad you see\nAre errors of the blood, none of the mind;\nLove made them not: with acture they may be,\nWhere neither party is nor true nor kind:\nThey sought their shame that so their shame did find;\nAnd so much less of shame in me remains,\nBy how much of me their reproach contains.\n\n'Among the many that mine eyes have seen,\nNot one whose flame my heart so much as warm'd,\nOr my affection put to the smallest teen,\nOr any of my leisures ever charm'd:\nHarm have I done to them, but ne'er was harm'd;\nKept hearts in liveries, but mine own was free,\nAnd reign'd, commanding in his monarchy.\n\n'Look here, what tributes wounded fancies sent me,\nOf paled pearls and rubies red as blood;\nFiguring that they their passions likewise lent me\nOf grief and blushes, aptly understood\nIn bloodless white and the encrimson'd mood;\nEffects of terror and dear modesty,\nEncamp'd in hearts, but fighting outwardly.\n\n'And, lo, behold these talents of their hair,\nWith twisted metal amorously impleach'd,\nI have received from many a several fair,\nTheir kind acceptance weepingly beseech'd,\nWith the annexions of fair gems enrich'd,\nAnd deep-brain'd sonnets that did amplify\nEach stone's dear nature, worth, and quality.\n\n'The diamond, why, 'twas beautiful and hard,\nWhereto his invised properties did tend;\nThe deep-green emerald, in whose fresh regard\nWeak sights their sickly radiance do amend;\nThe heaven-hued sapphire and the opal blend\nWith objects manifold: each several stone,\nWith wit well blazon'd, smiled or made some moan.\n\n'Lo, all these trophies of affections hot,\nOf pensived and subdued desires the tender,\nNature hath charged me that I hoard them not,\nBut yield them up where I myself must render,\nThat is, to you, my origin and ender;\nFor these, of force, must your oblations be,\nSince I their altar, you enpatron me.\n\n'O, then, advance of yours that phraseless hand,\nWhose white weighs down the airy scale of praise;\nTake all these similes to your own command,\nHallow'd with sighs that burning lungs did raise;\nWhat me your minister, for you obeys,\nWorks under you; and to your audit comes\nTheir distract parcels in combined sums.\n\n'Lo, this device was sent me from a nun,\nOr sister sanctified, of holiest note;\nWhich late her noble suit in court did shun,\nWhose rarest havings made the blossoms dote;\nFor she was sought by spirits of richest coat,\nBut kept cold distance, and did thence remove,\nTo spend her living in eternal love.\n\n'But, O my sweet, what labour is't to leave\nThe thing we have not, mastering what not strives,\nPlaying the place which did no form receive,\nPlaying patient sports in unconstrained gyves?\nShe that her fame so to herself contrives,\nThe scars of battle 'scapeth by the flight,\nAnd makes her absence valiant, not her might.\n\n'O, pardon me, in that my boast is true:\nThe accident which brought me to her eye\nUpon the moment did her force subdue,\nAnd now she would the caged cloister fly:\nReligious love put out Religion's eye:\nNot to be tempted, would she be immured,\nAnd now, to tempt, all liberty procured.\n\n'How mighty then you are, O, hear me tell!\nThe broken bosoms that to me belong\nHave emptied all their fountains in my well,\nAnd mine I pour your ocean all among:\nI strong o'er them, and you o'er me being strong,\nMust for your victory us all congest,\nAs compound love to physic your cold breast.\n\n'My parts had power to charm a sacred nun,\nWho, disciplined, ay, dieted in grace,\nBelieved her eyes when they to assail begun,\nAll vows and consecrations giving place:\nO most potential love! vow, bond, nor space,\nIn thee hath neither sting, knot, nor confine,\nFor thou art all, and all things else are thine.\n\n'When thou impressest, what are precepts worth\nOf stale example? When thou wilt inflame,\nHow coldly those impediments stand forth\nOf wealth, of filial fear, law, kindred, fame!\nLove's arms are peace, 'gainst rule, 'gainst sense,\n'gainst shame,\nAnd sweetens, in the suffering pangs it bears,\nThe aloes of all forces, shocks, and fears.\n\n'Now all these hearts that do on mine depend,\nFeeling it break, with bleeding groans they pine;\nAnd supplicant their sighs to you extend,\nTo leave the battery that you make 'gainst mine,\nLending soft audience to my sweet design,\nAnd credent soul to that strong-bonded oath\nThat shall prefer and undertake my troth.'\n\n'This said, his watery eyes he did dismount,\nWhose sights till then were levell'd on my face;\nEach cheek a river running from a fount\nWith brinish current downward flow'd apace:\nO, how the channel to the stream gave grace!\nWho glazed with crystal gate the glowing roses\nThat flame through water which their hue encloses.\n\n'O father, what a hell of witchcraft lies\nIn the small orb of one particular tear!\nBut with the inundation of the eyes\nWhat rocky heart to water will not wear?\nWhat breast so cold that is not warmed here?\nO cleft effect! cold modesty, hot wrath,\nBoth fire from hence and chill extincture hath.\n\n'For, lo, his passion, but an art of craft,\nEven there resolved my reason into tears;\nThere my white stole of chastity I daff'd,\nShook off my sober guards and civil fears;\nAppear to him, as he to me appears,\nAll melting; though our drops this difference bore,\nHis poison'd me, and mine did him restore.\n\n'In him a plenitude of subtle matter,\nApplied to cautels, all strange forms receives,\nOf burning blushes, or of weeping water,\nOr swooning paleness; and he takes and leaves,\nIn either's aptness, as it best deceives,\nTo blush at speeches rank to weep at woes,\nOr to turn white and swoon at tragic shows.\n\n'That not a heart which in his level came\nCould 'scape the hail of his all-hurting aim,\nShowing fair nature is both kind and tame;\nAnd, veil'd in them, did win whom he would maim:\nAgainst the thing he sought he would exclaim;\nWhen he most burn'd in heart-wish'd luxury,\nHe preach'd pure maid, and praised cold chastity.\n\n'Thus merely with the garment of a Grace\nThe naked and concealed fiend he cover'd;\nThat th' unexperient gave the tempter place,\nWhich like a cherubin above them hover'd.\nWho, young and simple, would not be so lover'd?\nAy me! I fell; and yet do question make\nWhat I should do again for such a sake.\n\n'O, that infected moisture of his eye,\nO, that false fire which in his cheek so glow'd,\nO, that forced thunder from his heart did fly,\nO, that sad breath his spongy lungs bestow'd,\nO, all that borrow'd motion seeming owed,\nWould yet again betray the fore-betray'd,\nAnd new pervert a reconciled maid!'"
    val loversComplaintInput = loversComplaintString.toLowerCase.split("\\s+").toSeq

    val phoenixAndTurtleKey = 3
    var phoenixAndTurtleString = "Let the bird of loudest lay,\nOn the sole Arabian tree,\nHerald sad and trumpet be,\nTo whose sound chaste wings obey.\n\nBut thou shrieking harbinger,\nFoul precurrer of the fiend,\nAugur of the fever's end,\nTo this troop come thou not near!\n\nFrom this session interdict\nEvery fowl of tyrant wing,\nSave the eagle, feather'd king:\nKeep the obsequy so strict.\n\nLet the priest in surplice white,\nThat defunctive music can,\nBe the death-divining swan,\nLest the requiem lack his right.\n\nAnd thou treble-dated crow,\nThat thy sable gender makest\nWith the breath thou givest and takest,\n'Mongst our mourners shalt thou go.\n\nHere the anthem doth commence:\nLove and constancy is dead;\nPhoenix and the turtle fled\nIn a mutual flame from hence.\n\nSo they loved, as love in twain\nHad the essence but in one;\nTwo distincts, division none:\nNumber there in love was slain.\n\nHearts remote, yet not asunder;\nDistance, and no space was seen\n'Twixt the turtle and his queen:\nBut in them it were a wonder.\n\nSo between them love did shine,\nThat the turtle saw his right\nFlaming in the phoenix' sight;\nEither was the other's mine.\n\nProperty was thus appalled,\nThat the self was not the same;\nSingle nature's double name\nNeither two nor one was called.\n\nReason, in itself confounded,\nSaw division grow together,\nTo themselves yet either neither,\nSimple were so well compounded,\n\nThat it cried, How true a twain\nSeemeth this concordant one!\nLove hath reason, reason none,\nIf what parts can so remain.\n\nWhereupon it made this threne\nTo the phoenix and the dove,\nCo-supremes and stars of love,\nAs chorus to their tragic scene.\n\nTHRENOS.\n\nBeauty, truth, and rarity,\nGrace in all simplicity,\nHere enclosed in cinders lie.\n\nDeath is now the phoenix' nest\nAnd the turtle's loyal breast\nTo eternity doth rest,\n\nLeaving no posterity:\n'Twas not their infirmity,\nIt was married chastity.\n\nTruth may seem, but cannot be:\nBeauty brag, but 'tis not she;\nTruth and beauty buried be.\n\nTo this urn let those repair\nThat are either true or fair\nFor these dead birds sigh a prayer."
    val phoenixAndTurtleInput = phoenixAndTurtleString.toLowerCase.split("\\s+").toSeq

    // 2. when
    val inputDs = env.fromCollection(Seq((passionatePilgrimKey, passionatePilgrimInput), (loversComplaintKey, loversComplaintInput), (phoenixAndTurtleKey, phoenixAndTurtleInput)))
    val resultCollection = new TfIdfTransformer().transform(inputDs).collect()

    // 3. then
    resultCollection.length should be (expectedResultCollectionLength)

  }

  behavior of "Test_06: Running TF-IDF on tree hard coded poems using stop words as parameter"
  it should "return different result comparing to test without stop words" in {

    val env = ExecutionEnvironment.getExecutionEnvironment

    // 1. given
    val expectedResultCollectionLength = 3
    val stopWords =  Set("the","a", "and", "in", "an", "I", "am", "she", "he", "any", "at", "so", "are", "on", "by")


    val passionatePilgrimKey = 1
    var passionatePilgrimString =  "When my love swears that she is made of truth,\nI do believe her, though I know she lies,\nThat she might think me some untutor'd youth,\nUnskilful in the world's false forgeries.\nThus vainly thinking that she thinks me young,\nAlthough I know my years be past the best,\nI smiling credit her false-speaking tongue,\nOutfacing faults in love with love's ill rest.\nBut wherefore says my love that she is young?\nAnd wherefore say not I that I am old?\nO, love's best habit is a soothing tongue,\nAnd age, in love, loves not to have years told.\nTherefore I'll lie with love, and love with me,\nSince that our faults in love thus smother'd be.\n\n\nTwo loves I have, of comfort and despair,\nThat like two spirits do suggest me still;\nMy better angel is a man right fair,\nMy worser spirit a woman colour'd ill.\nTo win me soon to hell, my female evil\nTempteth my better angel from my side,\nAnd would corrupt my saint to be a devil,\nWooing his purity with her fair pride.\nAnd whether that my angel be turn'd fiend,\nSuspect I may, yet not directly tell:\nFor being both to me, both to each friend,\nI guess one angel in another's hell;\nThe truth I shall not know, but live in doubt,\nTill my bad angel fire my good one out.\n\n\nDid not the heavenly rhetoric of thine eye,\n'Gainst whom the world could not hold argument,\nPersuade my heart to this false perjury?\nVows for thee broke deserve not punishment.\nA woman I forswore; but I will prove,\nThou being a goddess, I forswore not thee:\nMy vow was earthly, thou a heavenly love;\nThy grace being gain'd cures all disgrace in me.\nMy vow was breath, and breath a vapour is;\nThen, thou fair sun, that on this earth doth shine,\nExhale this vapour vow; in thee it is:\nIf broken, then it is no fault of mine.\nIf by me broke, what fool is not so wise\nTo break an oath, to win a paradise?\n\n\nSweet Cytherea, sitting by a brook\nWith young Adonis, lovely, fresh, and green,\nDid court the lad with many a lovely look,\nSuch looks as none could look but beauty's queen.\nShe told him stories to delight his ear;\nShe showed him favors to allure his eye;\nTo win his heart, she touch'd him here and there,\nTouches so soft still conquer chastity.\nBut whether unripe years did want conceit,\nOr he refused to take her figured proffer,\nThe tender nibbler would not touch the bait,\nBut smile and jest at every gentle offer:\nThen fell she on her back, fair queen, and toward:\nHe rose and ran away; ah, fool too froward!\n\n\nIf love make me forsworn, how shall I swear to love?\nO never faith could hold, if not to beauty vow'd:\nThough to myself forsworn, to thee I'll constant prove;\nThose thoughts, to me like oaks, to thee like osiers bow'd.\nStudy his bias leaves, and makes his book thine eyes,\nWhere all those pleasures live that art can comprehend.\nIf knowledge be the mark, to know thee shall suffice;\nWell learned is that tongue that well can thee commend;\nAll ignorant that soul that sees thee without wonder;\nWhich is to me some praise, that I thy parts admire:\nThine eye Jove's lightning seems, thy voice his dreadful\nthunder,\nWhich, not to anger bent, is music and sweet fire.\nCelestial as thou art, O do not love that wrong,\nTo sing heaven's praise with such an earthly tongue.\n\n\nScarce had the sun dried up the dewy morn,\nAnd scarce the herd gone to the hedge for shade,\nWhen Cytherea, all in love forlorn,\nA longing tarriance for Adonis made\nUnder an osier growing by a brook,\nA brook where Adon used to cool his spleen:\nHot was the day; she hotter that did look\nFor his approach, that often there had been.\nAnon he comes, and throws his mantle by,\nAnd stood stark naked on the brook's green brim:\nThe sun look'd on the world with glorious eye,\nYet not so wistly as this queen on him.\nHe, spying her, bounced in, whereas he stood:\n'O Jove,' quoth she, 'why was not I a flood!'\n\n\nFair is my love, but not so fair as fickle;\nMild as a dove, but neither true nor trusty;\nBrighter than glass, and yet, as glass is, brittle;\nSofter than wax, and yet, as iron, rusty:\nA lily pale, with damask dye to grace her,\nNone fairer, nor none falser to deface her.\n\nHer lips to mine how often hath she joined,\nBetween each kiss her oaths of true love swearing!\nHow many tales to please me hath she coined,\nDreading my love, the loss thereof still fearing!\nYet in the midst of all her pure protestings,\nHer faith, her oaths, her tears, and all were jestings.\n\nShe burn'd with love, as straw with fire flameth;\nShe burn'd out love, as soon as straw outburneth;\nShe framed the love, and yet she foil'd the framing;\nShe bade love last, and yet she fell a-turning.\nWas this a lover, or a lecher whether?\nBad in the best, though excellent in neither.\n\n\nIf music and sweet poetry agree,\nAs they must needs, the sister and the brother,\nThen must the love be great 'twixt thee and me,\nBecause thou lovest the one, and I the other.\nDowland to thee is dear, whose heavenly touch\nUpon the lute doth ravish human sense;\nSpenser to me, whose deep conceit is such\nAs, passing all conceit, needs no defence.\nThou lovest to hear the sweet melodious sound\nThat Phoebus' lute, the queen of music, makes;\nAnd I in deep delight am chiefly drown'd\nWhen as himself to singing he betakes.\nOne god is god of both, as poets feign;\nOne knight loves both, and both in thee remain.\n\n\nFair was the morn when the fair queen of love,\nPaler for sorrow than her milk-white dove,\nFor Adon's sake, a youngster proud and wild;\nHer stand she takes upon a steep-up hill:\nAnon Adonis comes with horn and hounds;\nShe, silly queen, with more than love's good will,\nForbade the boy he should not pass those grounds:\n'Once,' quoth she, 'did I see a fair sweet youth\nHere in these brakes deep-wounded with a boar,\nDeep in the thigh, a spectacle of ruth!\nSee, in my thigh,' quoth she, 'here was the sore.'\nShe showed hers: he saw more wounds than one,\nAnd blushing fled, and left her all alone.\n\n\nSweet rose, fair flower, untimely pluck'd, soon vaded,\nPluck'd in the bud, and vaded in the spring!\nBright orient pearl, alack, too timely shaded!\nFair creature, kill'd too soon by death's sharp sting!\nLike a green plum that hangs upon a tree,\nAnd falls, through wind, before the fall should be.\n\nI weep for thee, and yet no cause I have;\nFor why thou left'st me nothing in thy will:\nAnd yet thou left'st me more than I did crave;\nFor why I craved nothing of thee still:\nO yes, dear friend, I pardon crave of thee,\nThy discontent thou didst bequeath to me.\n\n\nVenus, with young Adonis sitting by her\nUnder a myrtle shade, began to woo him:\nShe told the youngling how god Mars did try her,\nAnd as he fell to her, so fell she to him.\n'Even thus,' quoth she, 'the warlike god embraced me,'\nAnd then she clipp'd Adonis in her arms;\n'Even thus,' quoth she, 'the warlike god unlaced me,'\nAs if the boy should use like loving charms;\n'Even thus,' quoth she, 'he seized on my lips,'\nAnd with her lips on his did act the seizure:\nAnd as she fetched breath, away he skips,\nAnd would not take her meaning nor her pleasure.\nAh, that I had my lady at this bay,\nTo kiss and clip me till I run away!\n\n\nCrabbed age and youth cannot live together:\nYouth is full of pleasance, age is full of care;\nYouth like summer morn, age like winter weather;\nYouth like summer brave, age like winter bare.\nYouth is full of sport, age's breath is short;\nYouth is nimble, age is lame;\nYouth is hot and bold, age is weak and cold;\nYouth is wild, and age is tame.\nAge, I do abhor thee; youth, I do adore thee;\nO, my love, my love is young!\nAge, I do defy thee: O, sweet shepherd, hie thee,\nFor methinks thou stay'st too long,\n\n\nBeauty is but a vain and doubtful good;\nA shining gloss that vadeth suddenly;\nA flower that dies when first it gins to bud;\nA brittle glass that's broken presently:\nA doubtful good, a gloss, a glass, a flower,\nLost, vaded, broken, dead within an hour.\n\nAnd as goods lost are seld or never found,\nAs vaded gloss no rubbing will refresh,\nAs flowers dead lie wither'd on the ground,\nAs broken glass no cement can redress,\nSo beauty blemish'd once's for ever lost,\nIn spite of physic, painting, pain and cost.\n\n\nGood night, good rest. Ah, neither be my share:\nShe bade good night that kept my rest away;\nAnd daff'd me to a cabin hang'd with care,\nTo descant on the doubts of my decay.\n'Farewell,' quoth she, 'and come again tomorrow:'\nFare well I could not, for I supp'd with sorrow.\n\nYet at my parting sweetly did she smile,\nIn scorn or friendship, nill I construe whether:\n'T may be, she joy'd to jest at my exile,\n'T may be, again to make me wander thither:\n'Wander,' a word for shadows like myself,\nAs take the pain, but cannot pluck the pelf.\n\n\nLord, how mine eyes throw gazes to the east!\nMy heart doth charge the watch; the morning rise\nDoth cite each moving sense from idle rest.\nNot daring trust the office of mine eyes,\nWhile Philomela sits and sings, I sit and mark,\nAnd wish her lays were tuned like the lark;\n\nFor she doth welcome daylight with her ditty,\nAnd drives away dark dismal-dreaming night:\nThe night so pack'd, I post unto my pretty;\nHeart hath his hope, and eyes their wished sight;\nSorrow changed to solace, solace mix'd with sorrow;\nFor why, she sigh'd and bade me come tomorrow.\n\nWere I with her, the night would post too soon;\nBut now are minutes added to the hours;\nTo spite me now, each minute seems a moon;\nYet not for me, shine sun to succor flowers!\nPack night, peep day; good day, of night now borrow:\nShort, night, to-night, and length thyself tomorrow.\n\nSonnet to sundry notes of music\n\nIt was a lording's daughter, the fairest one of three,\nThat liked of her master as well as well might be,\nTill looking on an Englishman, the fair'st that eye could see,\nHer fancy fell a-turning.\n\nLong was the combat doubtful that love with love did fight,\nTo leave the master loveless, or kill the gallant knight:\nTo put in practise either, alas, it was a spite\nUnto the silly damsel!\n\nBut one must be refused; more mickle was the pain\nThat nothing could be used to turn them both to gain,\nFor of the two the trusty knight was wounded with disdain:\nAlas, she could not help it!\n\nThus art with arms contending was victor of the day,\nWhich by a gift of learning did bear the maid away:\nThen, lullaby, the learned man hath got the lady gay;\nFor now my song is ended.\n\nSonnet to sundry notes of music\n\nOn a day, alack the day!\nLove, whose month was ever May,\nSpied a blossom passing fair,\nPlaying in the wanton air:\nThrough the velvet leaves the wind\nAll unseen, gan passage find;\nThat the lover, sick to death,\nWish'd himself the heaven's breath,\n'Air,' quoth he, 'thy cheeks may blow;\nAir, would I might triumph so!\nBut, alas! my hand hath sworn\nNe'er to pluck thee from thy thorn:\nVow, alack! for youth unmeet:\nYouth, so apt to pluck a sweet.\nThou for whom Jove would swear\nJuno but an Ethiope were;\nAnd deny himself for Jove,\nTurning mortal for thy love.'\n\nSonnet to sundry notes of music\n\nMy flocks feed not,\nMy ewes breed not,\nMy rams speed not,\nAll is amiss:\nLove's denying,\nFaith's defying,\nHeart's renying,\nCauser of this.\nAll my merry jigs are quite forgot,\nAll my lady's love is lost, God wot:\nWhere her faith was firmly fix'd in love,\nThere a nay is placed without remove.\nOne silly cross\nWrought all my loss;\nO frowning Fortune, cursed, fickle dame!\nFor now I see\nInconstancy\nMore in women than in men remain.\nIn black mourn I,\nAll fears scorn I,\nLove hath forlorn me,\nLiving in thrall:\nHeart is bleeding,\nAll help needing,\nO cruel speeding,\nFraughted with gall.\nMy shepherd's pipe can sound no deal;\nMy wether's bell rings doleful knell;\nMy curtail dog, that wont to have play'd\nPlays not at all, but seems afraid;\nMy sighs so deep\nProcure to weep,\nIn howling wise, to see my doleful plight.\nHow sighs resound\nThrough heartless ground,\n\nLike a thousand vanquish'd men in bloody fight!\nClear wells spring not,\nSweet birds sing not,\nGreen plants bring not\nForth their dye;\nHerds stand weeping,\nFlocks all sleeping,\nNymphs back peeping\nFearfully:\nAll our pleasure known to us poor swains,\nAll our merry meetings on the plains,\nAll our evening sport from us is fled,\nAll our love is lost, for Love is dead\nFarewell, sweet lass,\nThy like ne'er was\nFor a sweet content, the cause of all my moan:\nPoor Corydon\nMust live alone;\nOther help for him I see that there is none.\n\nSonnet to sundry notes of music\n\nWhen as thine eye hath chose the dame,\nAnd stall'd the deer that thou shouldst strike,\nLet reason rule things worthy blame,\nAs well as fancy partial might:\nTake counsel of some wiser head,\nNeither too young nor yet unwed.\n\nAnd when thou comest thy tale to tell,\nSmooth not thy tongue with filed talk,\nLest she some subtle practise smell,\nA cripple soon can find a halt;\nBut plainly say thou lovest her well,\n\nAnd set thy person forth to sell.\nWhat though her frowning brows be bent,\nHer cloudy looks will calm ere night:\nAnd then too late she will repent\nThat thus dissembled her delight;\nAnd twice desire, ere it be day,\nThat which with scorn she put away.\n\nWhat though she strive to try her strength,\nAnd ban and brawl, and say thee nay,\nHer feeble force will yield at length,\nWhen craft hath taught her thus to say,\n'Had women been so strong as men,\nIn faith, you had not had it then.'\n\nAnd to her will frame all thy ways;\nSpare not to spend, and chiefly there\nWhere thy desert may merit praise,\nBy ringing in thy lady's ear:\nThe strongest castle, tower, and town,\nThe golden bullet beats it down.\n\nServe always with assured trust,\nAnd in thy suit be humble true;\nUnless thy lady prove unjust,\nPress never thou to choose anew:\nWhen time shall serve, be thou not slack\nTo proffer, though she put thee back.\n\nThe wiles and guiles that women work,\nDissembled with an outward show,\nThe tricks and toys that in them lurk,\nThe cock that treads them shall not know.\nHave you not heard it said full oft,\nA woman's nay doth stand for nought?\n\nThink women still to strive with men,\nTo sin and never for to saint:\nThere is no heaven, by holy then,\nWhen time with age doth them attaint.\nWere kisses all the joys in bed,\nOne woman would another wed.\n\nBut, soft! enough, too much, I fear\nLest that my mistress hear my song,\nShe will not stick to round me i' the ear,\nTo teach my tongue to be so long:\nYet will she blush, here be it said,\nTo hear her secrets so bewray'd.\n\nSonnet to sundry notes of music\n\nLive with me, and be my love,\nAnd we will all the pleasures prove\nThat hills and valleys, dales and fields,\nAnd all the craggy mountains yields.\n\nThere will we sit upon the rocks,\nAnd see the shepherds feed their flocks,\nBy shallow rivers, by whose falls\nMelodious birds sing madrigals.\n\nThere will I make thee a bed of roses,\nWith a thousand fragrant posies,\nA cap of flowers, and a kirtle\nEmbroider'd all with leaves of myrtle.\n\nA belt of straw and ivy buds,\nWith coral clasps and amber studs;\nAnd if these pleasures may thee move,\nThen live with me and be my love.\n\n[Love's Answer]\nIf that the world and love were young,\nAnd truth in every shepherd's tongue,\nThese pretty pleasures might me move\nTo live with thee and be thy love.\n\nSonnet to sundry notes of music\n\nAs it fell upon a day\nIn the merry month of May,\nSitting in a pleasant shade\nWhich a grove of myrtles made,\nBeasts did leap, and birds did sing,\nTrees did grow, and plants did spring;\nEvery thing did banish moan,\nSave the nightingale alone:\nShe, poor bird, as all forlorn,\nLean'd her breast up-till a thorn\nAnd there sung the dolefull'st ditty,\nThat to hear it was great pity:\n'Fie, fie, fie,' now would she cry;\n'Tereu, tereu!' by and by;\nThat to hear her so complain,\nScarce I could from tears refrain;\nFor her griefs, so lively shown,\nMade me think upon mine own.\nAh, thought I, thou mourn'st in vain!\nNone takes pity on thy pain:\nSenseless trees they cannot hear thee;\nRuthless beasts they will not cheer thee:\nKing Pandion he is dead;\nAll thy friends are lapp'd in lead;\nAll thy fellow birds do sing,\nCareless of thy sorrowing.\nEven so, poor bird, like thee,\nNone alive will pity me.\nWhilst as fickle Fortune smiled,\nThou and I were both beguiled.\nEvery one that flatters thee\nIs no friend in misery.\nWords are easy, like the wind;\nFaithful friends are hard to find:\nEvery man will be thy friend\nWhilst thou hast wherewith to spend;\nBut if store of crowns be scant,\nNo man will supply thy want.\nIf that one be prodigal,\nBountiful they will him call,\nAnd with such-like flattering,\n'Pity but he were a king;'\nIf he be addict to vice,\nQuickly him they will entice;\nIf to women he be bent,\nThey have at commandement:\nBut if Fortune once do frown,\nThen farewell his great renown\nThey that fawn'd on him before\nUse his company no more.\nHe that is thy friend indeed,\nHe will help thee in thy need:\nIf thou sorrow, he will weep;\nIf thou wake, he cannot sleep;\nThus of every grief in heart\nHe with thee doth bear a part.\nThese are certain signs to know\nFaithful friend from flattering foe."
    val passionatePilgrimInput = passionatePilgrimString.toLowerCase.split("\\s+").toSeq

    val loversComplaintKey = 2
    var loversComplaintString = "From off a hill whose concave womb reworded\nA plaintful story from a sistering vale,\nMy spirits to attend this double voice accorded,\nAnd down I laid to list the sad-tuned tale;\nEre long espied a fickle maid full pale,\nTearing of papers, breaking rings a-twain,\nStorming her world with sorrow's wind and rain.\n\nUpon her head a platted hive of straw,\nWhich fortified her visage from the sun,\nWhereon the thought might think sometime it saw\nThe carcass of beauty spent and done:\nTime had not scythed all that youth begun,\nNor youth all quit; but, spite of heaven's fell rage,\nSome beauty peep'd through lattice of sear'd age.\n\nOft did she heave her napkin to her eyne,\nWhich on it had conceited characters,\nLaundering the silken figures in the brine\nThat season'd woe had pelleted in tears,\nAnd often reading what contents it bears;\nAs often shrieking undistinguish'd woe,\nIn clamours of all size, both high and low.\n\nSometimes her levell'd eyes their carriage ride,\nAs they did battery to the spheres intend;\nSometime diverted their poor balls are tied\nTo the orbed earth; sometimes they do extend\nTheir view right on; anon their gazes lend\nTo every place at once, and, nowhere fix'd,\nThe mind and sight distractedly commix'd.\n\nHer hair, nor loose nor tied in formal plat,\nProclaim'd in her a careless hand of pride\nFor some, untuck'd, descended her sheaved hat,\nHanging her pale and pined cheek beside;\nSome in her threaden fillet still did bide,\nAnd true to bondage would not break from thence,\nThough slackly braided in loose negligence.\n\nA thousand favours from a maund she drew\nOf amber, crystal, and of beaded jet,\nWhich one by one she in a river threw,\nUpon whose weeping margent she was set;\nLike usury, applying wet to wet,\nOr monarch's hands that let not bounty fall\nWhere want cries some, but where excess begs all.\n\nOf folded schedules had she many a one,\nWhich she perused, sigh'd, tore, and gave the flood;\nCrack'd many a ring of posied gold and bone\nBidding them find their sepulchres in mud;\nFound yet moe letters sadly penn'd in blood,\nWith sleided silk feat and affectedly\nEnswathed, and seal'd to curious secrecy.\n\nThese often bathed she in her fluxive eyes,\nAnd often kiss'd, and often 'gan to tear:\nCried 'O false blood, thou register of lies,\nWhat unapproved witness dost thou bear!\nInk would have seem'd more black and damned here!'\nThis said, in top of rage the lines she rents,\nBig discontent so breaking their contents.\n\nA reverend man that grazed his cattle nigh\nSometime a blusterer, that the ruffle knew\nOf court, of city, and had let go by\nThe swiftest hours, observed as they flew\nTowards this afflicted fancy fastly drew,\nAnd, privileged by age, desires to know\nIn brief the grounds and motives of her woe.\n\nSo slides he down upon his grained bat,\nAnd comely-distant sits he by her side;\nWhen he again desires her, being sat,\nHer grievance with his hearing to divide:\nIf that from him there may be aught applied\nWhich may her suffering ecstasy assuage,\n'Tis promised in the charity of age.\n\n'Father,' she says, 'though in me you behold\nThe injury of many a blasting hour,\nLet it not tell your judgment I am old;\nNot age, but sorrow, over me hath power:\nI might as yet have been a spreading flower,\nFresh to myself, If I had self-applied\nLove to myself and to no love beside.\n\n'But, woe is me! too early I attended\nA youthful suit, it was to gain my grace\nOf one by nature's outwards so commended,\nThat maidens' eyes stuck over all his face:\nLove lack'd a dwelling, and made him her place;\nAnd when in his fair parts she did abide,\nShe was new lodged and newly deified.\n\n'His browny locks did hang in crooked curls;\nAnd every light occasion of the wind\nUpon his lips their silken parcels hurls.\nWhat's sweet to do, to do will aptly find:\nEach eye that saw him did enchant the mind,\nFor on his visage was in little drawn\nWhat largeness thinks in Paradise was sawn.\n\n'Small show of man was yet upon his chin;\nHis phoenix down began but to appear\nLike unshorn velvet on that termless skin\nWhose bare out-bragg'd the web it seem'd to wear:\nYet show'd his visage by that cost more dear;\nAnd nice affections wavering stood in doubt\nIf best were as it was, or best without.\n\n'His qualities were beauteous as his form,\nFor maiden-tongued he was, and thereof free;\nYet, if men moved him, was he such a storm\nAs oft 'twixt May and April is to see,\nWhen winds breathe sweet, untidy though they be.\nHis rudeness so with his authorized youth\nDid livery falseness in a pride of truth.\n\n'Well could he ride, and often men would say\n'That horse his mettle from his rider takes:\nProud of subjection, noble by the sway,\nWhat rounds, what bounds, what course, what stop\nhe makes!'\nAnd controversy hence a question takes,\nWhether the horse by him became his deed,\nOr he his manage by the well-doing steed.\n\n'But quickly on this side the verdict went:\nHis real habitude gave life and grace\nTo appertainings and to ornament,\nAccomplish'd in himself, not in his case:\nAll aids, themselves made fairer by their place,\nCame for additions; yet their purposed trim\nPieced not his grace, but were all graced by him.\n\n'So on the tip of his subduing tongue\nAll kinds of arguments and question deep,\nAll replication prompt, and reason strong,\nFor his advantage still did wake and sleep:\nTo make the weeper laugh, the laugher weep,\nHe had the dialect and different skill,\nCatching all passions in his craft of will:\n\n'That he did in the general bosom reign\nOf young, of old; and sexes both enchanted,\nTo dwell with him in thoughts, or to remain\nIn personal duty, following where he haunted:\nConsents bewitch'd, ere he desire, have granted;\nAnd dialogued for him what he would say,\nAsk'd their own wills, and made their wills obey.\n\n'Many there were that did his picture get,\nTo serve their eyes, and in it put their mind;\nLike fools that in th' imagination set\nThe goodly objects which abroad they find\nOf lands and mansions, theirs in thought assign'd;\nAnd labouring in moe pleasures to bestow them\nThan the true gouty landlord which doth owe them:\n\n'So many have, that never touch'd his hand,\nSweetly supposed them mistress of his heart.\nMy woeful self, that did in freedom stand,\nAnd was my own fee-simple, not in part,\nWhat with his art in youth, and youth in art,\nThrew my affections in his charmed power,\nReserved the stalk and gave him all my flower.\n\n'Yet did I not, as some my equals did,\nDemand of him, nor being desired yielded;\nFinding myself in honour so forbid,\nWith safest distance I mine honour shielded:\nExperience for me many bulwarks builded\nOf proofs new-bleeding, which remain'd the foil\nOf this false jewel, and his amorous spoil.\n\n'But, ah, who ever shunn'd by precedent\nThe destined ill she must herself assay?\nOr forced examples, 'gainst her own content,\nTo put the by-past perils in her way?\nCounsel may stop awhile what will not stay;\nFor when we rage, advice is often seen\nBy blunting us to make our wits more keen.\n\n'Nor gives it satisfaction to our blood,\nThat we must curb it upon others' proof;\nTo be forbod the sweets that seem so good,\nFor fear of harms that preach in our behoof.\nO appetite, from judgment stand aloof!\nThe one a palate hath that needs will taste,\nThough Reason weep, and cry, 'It is thy last.'\n\n'For further I could say 'This man's untrue,'\nAnd knew the patterns of his foul beguiling;\nHeard where his plants in others' orchards grew,\nSaw how deceits were gilded in his smiling;\nKnew vows were ever brokers to defiling;\nThought characters and words merely but art,\nAnd bastards of his foul adulterate heart.\n\n'And long upon these terms I held my city,\nTill thus he gan besiege me: 'Gentle maid,\nHave of my suffering youth some feeling pity,\nAnd be not of my holy vows afraid:\nThat's to ye sworn to none was ever said;\nFor feasts of love I have been call'd unto,\nTill now did ne'er invite, nor never woo.\n\n'All my offences that abroad you see\nAre errors of the blood, none of the mind;\nLove made them not: with acture they may be,\nWhere neither party is nor true nor kind:\nThey sought their shame that so their shame did find;\nAnd so much less of shame in me remains,\nBy how much of me their reproach contains.\n\n'Among the many that mine eyes have seen,\nNot one whose flame my heart so much as warm'd,\nOr my affection put to the smallest teen,\nOr any of my leisures ever charm'd:\nHarm have I done to them, but ne'er was harm'd;\nKept hearts in liveries, but mine own was free,\nAnd reign'd, commanding in his monarchy.\n\n'Look here, what tributes wounded fancies sent me,\nOf paled pearls and rubies red as blood;\nFiguring that they their passions likewise lent me\nOf grief and blushes, aptly understood\nIn bloodless white and the encrimson'd mood;\nEffects of terror and dear modesty,\nEncamp'd in hearts, but fighting outwardly.\n\n'And, lo, behold these talents of their hair,\nWith twisted metal amorously impleach'd,\nI have received from many a several fair,\nTheir kind acceptance weepingly beseech'd,\nWith the annexions of fair gems enrich'd,\nAnd deep-brain'd sonnets that did amplify\nEach stone's dear nature, worth, and quality.\n\n'The diamond, why, 'twas beautiful and hard,\nWhereto his invised properties did tend;\nThe deep-green emerald, in whose fresh regard\nWeak sights their sickly radiance do amend;\nThe heaven-hued sapphire and the opal blend\nWith objects manifold: each several stone,\nWith wit well blazon'd, smiled or made some moan.\n\n'Lo, all these trophies of affections hot,\nOf pensived and subdued desires the tender,\nNature hath charged me that I hoard them not,\nBut yield them up where I myself must render,\nThat is, to you, my origin and ender;\nFor these, of force, must your oblations be,\nSince I their altar, you enpatron me.\n\n'O, then, advance of yours that phraseless hand,\nWhose white weighs down the airy scale of praise;\nTake all these similes to your own command,\nHallow'd with sighs that burning lungs did raise;\nWhat me your minister, for you obeys,\nWorks under you; and to your audit comes\nTheir distract parcels in combined sums.\n\n'Lo, this device was sent me from a nun,\nOr sister sanctified, of holiest note;\nWhich late her noble suit in court did shun,\nWhose rarest havings made the blossoms dote;\nFor she was sought by spirits of richest coat,\nBut kept cold distance, and did thence remove,\nTo spend her living in eternal love.\n\n'But, O my sweet, what labour is't to leave\nThe thing we have not, mastering what not strives,\nPlaying the place which did no form receive,\nPlaying patient sports in unconstrained gyves?\nShe that her fame so to herself contrives,\nThe scars of battle 'scapeth by the flight,\nAnd makes her absence valiant, not her might.\n\n'O, pardon me, in that my boast is true:\nThe accident which brought me to her eye\nUpon the moment did her force subdue,\nAnd now she would the caged cloister fly:\nReligious love put out Religion's eye:\nNot to be tempted, would she be immured,\nAnd now, to tempt, all liberty procured.\n\n'How mighty then you are, O, hear me tell!\nThe broken bosoms that to me belong\nHave emptied all their fountains in my well,\nAnd mine I pour your ocean all among:\nI strong o'er them, and you o'er me being strong,\nMust for your victory us all congest,\nAs compound love to physic your cold breast.\n\n'My parts had power to charm a sacred nun,\nWho, disciplined, ay, dieted in grace,\nBelieved her eyes when they to assail begun,\nAll vows and consecrations giving place:\nO most potential love! vow, bond, nor space,\nIn thee hath neither sting, knot, nor confine,\nFor thou art all, and all things else are thine.\n\n'When thou impressest, what are precepts worth\nOf stale example? When thou wilt inflame,\nHow coldly those impediments stand forth\nOf wealth, of filial fear, law, kindred, fame!\nLove's arms are peace, 'gainst rule, 'gainst sense,\n'gainst shame,\nAnd sweetens, in the suffering pangs it bears,\nThe aloes of all forces, shocks, and fears.\n\n'Now all these hearts that do on mine depend,\nFeeling it break, with bleeding groans they pine;\nAnd supplicant their sighs to you extend,\nTo leave the battery that you make 'gainst mine,\nLending soft audience to my sweet design,\nAnd credent soul to that strong-bonded oath\nThat shall prefer and undertake my troth.'\n\n'This said, his watery eyes he did dismount,\nWhose sights till then were levell'd on my face;\nEach cheek a river running from a fount\nWith brinish current downward flow'd apace:\nO, how the channel to the stream gave grace!\nWho glazed with crystal gate the glowing roses\nThat flame through water which their hue encloses.\n\n'O father, what a hell of witchcraft lies\nIn the small orb of one particular tear!\nBut with the inundation of the eyes\nWhat rocky heart to water will not wear?\nWhat breast so cold that is not warmed here?\nO cleft effect! cold modesty, hot wrath,\nBoth fire from hence and chill extincture hath.\n\n'For, lo, his passion, but an art of craft,\nEven there resolved my reason into tears;\nThere my white stole of chastity I daff'd,\nShook off my sober guards and civil fears;\nAppear to him, as he to me appears,\nAll melting; though our drops this difference bore,\nHis poison'd me, and mine did him restore.\n\n'In him a plenitude of subtle matter,\nApplied to cautels, all strange forms receives,\nOf burning blushes, or of weeping water,\nOr swooning paleness; and he takes and leaves,\nIn either's aptness, as it best deceives,\nTo blush at speeches rank to weep at woes,\nOr to turn white and swoon at tragic shows.\n\n'That not a heart which in his level came\nCould 'scape the hail of his all-hurting aim,\nShowing fair nature is both kind and tame;\nAnd, veil'd in them, did win whom he would maim:\nAgainst the thing he sought he would exclaim;\nWhen he most burn'd in heart-wish'd luxury,\nHe preach'd pure maid, and praised cold chastity.\n\n'Thus merely with the garment of a Grace\nThe naked and concealed fiend he cover'd;\nThat th' unexperient gave the tempter place,\nWhich like a cherubin above them hover'd.\nWho, young and simple, would not be so lover'd?\nAy me! I fell; and yet do question make\nWhat I should do again for such a sake.\n\n'O, that infected moisture of his eye,\nO, that false fire which in his cheek so glow'd,\nO, that forced thunder from his heart did fly,\nO, that sad breath his spongy lungs bestow'd,\nO, all that borrow'd motion seeming owed,\nWould yet again betray the fore-betray'd,\nAnd new pervert a reconciled maid!'"
    val loversComplaintInput = loversComplaintString.toLowerCase.split("\\s+").toSeq

    val phoenixAndTurtleKey = 3
    var phoenixAndTurtleString = "Let the bird of loudest lay,\nOn the sole Arabian tree,\nHerald sad and trumpet be,\nTo whose sound chaste wings obey.\n\nBut thou shrieking harbinger,\nFoul precurrer of the fiend,\nAugur of the fever's end,\nTo this troop come thou not near!\n\nFrom this session interdict\nEvery fowl of tyrant wing,\nSave the eagle, feather'd king:\nKeep the obsequy so strict.\n\nLet the priest in surplice white,\nThat defunctive music can,\nBe the death-divining swan,\nLest the requiem lack his right.\n\nAnd thou treble-dated crow,\nThat thy sable gender makest\nWith the breath thou givest and takest,\n'Mongst our mourners shalt thou go.\n\nHere the anthem doth commence:\nLove and constancy is dead;\nPhoenix and the turtle fled\nIn a mutual flame from hence.\n\nSo they loved, as love in twain\nHad the essence but in one;\nTwo distincts, division none:\nNumber there in love was slain.\n\nHearts remote, yet not asunder;\nDistance, and no space was seen\n'Twixt the turtle and his queen:\nBut in them it were a wonder.\n\nSo between them love did shine,\nThat the turtle saw his right\nFlaming in the phoenix' sight;\nEither was the other's mine.\n\nProperty was thus appalled,\nThat the self was not the same;\nSingle nature's double name\nNeither two nor one was called.\n\nReason, in itself confounded,\nSaw division grow together,\nTo themselves yet either neither,\nSimple were so well compounded,\n\nThat it cried, How true a twain\nSeemeth this concordant one!\nLove hath reason, reason none,\nIf what parts can so remain.\n\nWhereupon it made this threne\nTo the phoenix and the dove,\nCo-supremes and stars of love,\nAs chorus to their tragic scene.\n\nTHRENOS.\n\nBeauty, truth, and rarity,\nGrace in all simplicity,\nHere enclosed in cinders lie.\n\nDeath is now the phoenix' nest\nAnd the turtle's loyal breast\nTo eternity doth rest,\n\nLeaving no posterity:\n'Twas not their infirmity,\nIt was married chastity.\n\nTruth may seem, but cannot be:\nBeauty brag, but 'tis not she;\nTruth and beauty buried be.\n\nTo this urn let those repair\nThat are either true or fair\nFor these dead birds sigh a prayer."
    val phoenixAndTurtleInput = phoenixAndTurtleString.toLowerCase.split("\\s+").toSeq

    // 2. when
    val params = new ParameterMap()
    params.add(StopWordParameter, stopWords)

    val inputDs = env.fromCollection(Seq((passionatePilgrimKey, passionatePilgrimInput), (loversComplaintKey, loversComplaintInput), (phoenixAndTurtleKey, phoenixAndTurtleInput)))
    val resultCollection = new TfIdfTransformer().transform(inputDs,params).collect()

    // 3. then
    resultCollection.length should be (expectedResultCollectionLength)

    0 should be (0)

  }

  behavior of "Test_07: Running TF-IDF on tree hard coded poems with normalization when tf is divided by the total number of terms in the document "
  it should "return different result comparing to test without stop words" in {

    0 should be (0)

  }


  //        document         indexe     werte
  // Buffer(1, SparseVector((1, 3, 7), (5.6, 7.8, 6,9))


}
